<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Building-site</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <style>
            *{margin: 0; padding: 0;}
            div#test{width: 500px; height: 30px; background-color: #ccc; position: relative; margin: 10px auto;}
            div#indiv{width: 30px; height: 30px; background-color: red; position: absolute;}
        </style>
    </head>
    <body>
    <div id="test">
        <div id="indiv"></div>
    </div>
    </body>
    <script src="compatibility.js" type="text/javascript" charset="utf-8" async defer></script>
    <script>
    window.onload = function(){
        var oDiv1 = document.getElementById('test');
        var oDiv2 = document.getElementById('indiv');
        // var disX = 0;
        // var disY = 0;
    //     oDiv.onmousedown=function (ev)
    //         {
    //         var oEvent=ev||event;
            
    //         disX=oEvent.clientX-oDiv.offsetLeft;
    //         disY=oEvent.clientY-oDiv.offsetTop;
            
    //         document.onmousemove=function (ev)
    //         {
    //             var oEvent=ev||event;
                
    //             oDiv.style.left=oEvent.clientX-disX+'px';
    //             oDiv.style.top=oEvent.clientY-disY+'px';
    //         };
    //     }
    // }
        oDiv2.onmousedown = function(ev){
            var oEvent = ev||event;

            var disX = oEvent.clientX - oDiv2.offsetLeft;
            // var disY = oEvent.clientY - oDiv2.offsetTop;
            // console.log(disX);

            oDiv1.onmousemove = function(ev){
                var oEvent = ev||event;
                var l = oEvent.clientX - disX;
                // var t = oEvent.clientY - disY;
                if(l<0){
                    l = 0;
                }else if(l>oDiv1.offsetWidth - oDiv2.offsetWidth){
                    l = oDiv1.offsetWidth - oDiv2.offsetWidth;
                }
                // if(t<50){
                //     t = 0;
                // }else if(t>oDiv1.offsetHeight - oDiv2.offsetHeight - 50){
                //     t = oDiv1.offsetHeight - oDiv2.offsetHeight;
                // }

                oDiv2.style.left = l + "px";
                // oDiv2.style.top = t + "px";


            }

            oDiv1.onmouseup = function(){
                oDiv1.onmousemove = null;
                oDiv1.onmouseup = null;
            }

            return false;
        }
}
    </script>
</html>